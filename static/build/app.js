loadFile({path:"/front/app.js",pathName:"/front/app.js",name:"app.js",dirName:"/front/",contents:'"use strict";var process=require("process"),_=require("underscore"),routes=require("../configuration/routes"),$=require("jquery");module.exports={start:function(){var t=this;return this.setVars(),window.addEventListener("load",function(e){t.loadComponents(),t.setRoutes(),t.registerEvents(),t.get("history").start({pushState:!0,silent:!0})}),this},set:function(t,e){this[t]=e},get:function(t){return this[t]},setVars:function(){this.set("classPath","/front"),this.set("commonPath",process.cwd()+"/common")},loadComponents:function(){var t=this,e=require("../configuration/components");_.pairs(e).forEach(function(e){t.set(e[0],e[1].init())})},setRoutes:function(){var t=this;_.pairs(routes).forEach(function(e){for(var r=[t.get("commonPath"),t.get("classPath")],n=void 0;n=r.shift();)try{var i=require(""+n+"/routers/"+e[0]);new i({routes:e[1]});break}catch(s){}})},registerEvents:function(){var t=this;$(document).on("click","a[href]:not(.link_external)",function(e){var r=e.target,n=r.getAttribute("href"),i=-1==n.indexOf("http")&&-1==n.indexOf("www")&&-1==n.indexOf("javascript");i&&(e.preventDefault(),t.get("history").navigate(n,{trigger:!0}))}),$(document).on("submit","form",function(t){t.preventDefault()})},serverSide:function(t){},clientSide:function(t){t()}};'}),loadFile({path:"/front/index.js",pathName:"/front/index.js",name:"index.js",dirName:"/front/",contents:'"use strict";window.app=require("./app"),app.start();'}),loadFile({path:"/front/classes/dom-document.js",pathName:"/front/classes/dom-document.js",name:"dom-document.js",dirName:"/front/classes/",contents:'"use strict";function checkScript(e){var t=this;return new Promise(function(r,n){var o=Array.from(document.querySelectorAll("script"));if(o.find(function(t){return t.getAttribute("src")==e}))r();else{var c=document.createElement("script");c.type="text/javascript",c.src=e,c.onload=function(){clearTimeout(i),r()},c.onreadystatechange=function(){"complete"==t.readyState&&(clearTimeout(i),r())},document.body.appendChild(c);var i=setTimeout(function(){n("can not load "+e)},15e3)}})}function loadStyles(e){return new Promise(function(t,r){var n=document.createElement("link");n.setAttribute("href",e),n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css");var o=void 0,c=void 0;"sheet"in n?(o="sheet",c="cssRules"):(o="styleSheet",c="rules");var i=setInterval(function(){try{n[o]&&n[o][c].length&&(clearInterval(i),clearTimeout(u),t())}catch(e){}finally{}},10),u=setTimeout(function(){clearInterval(i),clearTimeout(u),document.head.removeChild(n),r("can not load "+e)},15e3);document.head.appendChild(n)})}function checkStyles(e,t){return new Promise(function(r){t.styles?!function(){var t=Array.from(document.querySelectorAll("link[rel=stylesheet]")),n=""+build.prefix+"/"+bundleResult[e].styles;t.find(function(e){return e.getAttribute("href")==n})?r():loadStyles(n).then(r)}():r()})}function checkJS(e,t){if(t.js){var r=""+build.prefix+"/"+bundleResult[e].js;return checkScript(r)}return Promise.resolve()}function checkTemplates(e,t){if(t.templates){var r=""+build.prefix+"/"+bundleResult[e].templates;return checkScript(r)}return Promise.resolve()}function checkSVG(e,t){if(!t.svg)return Promise.resolve();var r=function(){var t=""+build.prefix+"/"+bundleResult[e].svg;return{v:new Promise(function(e){document.querySelector(\'[data-src="\'+t+\'"]\')?e():!function(){var r=new XMLHttpRequest;r.open("GET",t,!0),r.send(),r.onload=function(){var n=document.createElement("div");n.setAttribute("data-src",t),n.innerHTML=r.responseText,n.style.display="none",document.body.insertBefore(n,document.body.childNodes[0]),e()}}()})}}();return"object"==typeof r?r.v:void 0}var _prototypeProperties=function(e,t,r){t&&Object.defineProperties(e,t),r&&Object.defineProperties(e.prototype,r)},_classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},$=require("jquery"),process=require("process"),_=require("underscore"),bundleResult=require(process.cwd()+"/static/bundle-result"),build=require(process.cwd()+"/configuration/static");module.exports=function(){var e=function(t){_classCallCheck(this,e),this.theme=t};return _prototypeProperties(e,null,{loadTheme:{value:function(){var e=this;return new Promise(function(t){_.pairs(e.theme.bundles).reduce(function(e,t){return e.then(function(){return Promise.all([checkStyles.apply(null,t),checkJS.apply(null,t),checkTemplates.apply(null,t),checkSVG.apply(null,t)])})},Promise.resolve()).then(t)})},writable:!0,configurable:!0},setBlock:{value:function(e,t){$(document.all[""+e+"-block"]).html(t)},writable:!0,configurable:!0},setTitle:{value:function(e){document.title=e},writable:!0,configurable:!0},setMeta:{value:function(e){Array.from(document.head.querySelectorAll("meta")).forEach(function(e){document.head.removeChild(e)}),$(document.head).append(e)},writable:!0,configurable:!0},initViews:{value:function(e){var t=this;e.forEach(function(e){new(require(""+t.theme.viewsPath+"/"+e))(t.theme)})},writable:!0,configurable:!0}}),e}();'}),loadFile({path:"/front/routers/base.js",pathName:"/front/routers/base.js",name:"base.js",dirName:"/front/routers/",contents:'"use strict";var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){for(var r,i=[],o=e[Symbol.iterator]();!(r=o.next()).done&&(i.push(r.value),!t||i.length!==t););return i}throw new TypeError("Invalid attempt to destructure non-iterable instance")},_prototypeProperties=function(e,t,r){t&&Object.defineProperties(e,t),r&&Object.defineProperties(e.prototype,r)},_inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},_classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},_=require("underscore"),history=app.get("history"),EventEmitter=require("events");module.exports=function(e){var t=function(e){_classCallCheck(this,t),Object.assign(this,e),this._bindRoutes()};return _inherits(t,e),_prototypeProperties(t,null,{route:{value:function r(r,e,t){var i=this;return _.isRegExp(r)||(r=this._routeToRegExp(r)),_.isFunction(e)&&(t=e,e=""),t||(t=this[e]),history.route(r,function(o){var n=i._extractParameters(r,o);i.execute(t,n,e)!==!1&&(i.emit.apply(i,["route:"+e].concat(n)),i.emit("route",e,n),history.emit("route",i,e,n))}),this},writable:!0,configurable:!0},execute:{value:function(e,t,r){e&&e.apply(this,t)},writable:!0,configurable:!0},navigate:{value:function(e,t){return history.navigate(e,t),this},writable:!0,configurable:!0},_bindRoutes:{value:function(){if(this.routes){this.removeSlashes(),this.routes=_.result(this,"routes");for(var e=void 0,t=_.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},writable:!0,configurable:!0},removeSlashes:{value:function(){this.routes=_.pairs(this.routes).reduce(function(e,t){var r=_slicedToArray(t,2),i=r[0],o=r[1];return i.startsWith("/")&&(i=i.slice(1)),e[i]=o,e},{})},writable:!0,configurable:!0},_routeToRegExp:{value:function(e){var t=/\\((.*?)\\)/g,r=/(\\(\\?)?:\\w+/g,i=/\\*\\w+/g,o=/[\\-{}\\[\\]+?.,\\\\\\^$|#\\s]/g;return e=e.replace(o,"\\\\$&").replace(t,"(?:$1)?").replace(r,function(e,t){return t?e:"([^/?]+)"}).replace(i,"([^?]*?)"),new RegExp("^"+e+"(?:\\\\?([\\\\s\\\\S]*))?$")},writable:!0,configurable:!0},_extractParameters:{value:function(e,t){var r=e.exec(t).slice(1);return _.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})},writable:!0,configurable:!0},loadPage:{value:function(){this.emit("PageLoaded")},writable:!0,configurable:!0}}),t}(EventEmitter);'}),loadFile({path:"/common/modules/history/index.js",pathName:"/common/modules/history/index.js",name:"index.js",dirName:"/common/modules/history/",contents:'"use strict";var EventEmitter=require("events"),_=require("underscore"),routeStripper=/^[#\\/]|\\s+$/g,rootStripper=/^\\/+|\\/+$/g,pathStripper=/#.*$/;module.exports=Object.defineProperties({handlers:[],started:!1,interval:50,atRoot:function(){var t=this.location.pathname.replace(/[^\\/]$/,"$&/");return t===this.root&&!this.getSearch()},matchRoot:function(){var t=this.decodeFragment(this.location.pathname),e=t.slice(0,this.root.length-1)+"/";return e===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(routeStripper,"")},start:function(t){if(this.started)throw new Error("history has already been started");if(this.started=!0,this.applyOptions(t),this.root=("/"+this.root+"/").replace(rootStripper,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}return this.hashChangeSupport(),this.urlStateListeners(),this.options.silent?void 0:this.loadUrl()},applyOptions:function(t){this.options=_.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment()},hashChangeSupport:function(){if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var t=document.body,e=t.insertBefore(this.iframe,t.firstChild).contentWindow;e.document.open(),e.document.close(),e.location.hash="#"+this.fragment}},urlStateListeners:function(){var t=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?t("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval))},stop:function(){this.removeListeners(),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),this.started=!1},removeListeners:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1)},route:function t(t,e){this.handlers.unshift({route:t,callback:e})},_checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(t){return this.matchRoot()?(t=this.fragment=this.getFragment(t),this.handlers.some(function(e){return e.route.test(t)?(e.callback(t),!0):void 0})):!1},navigate:function(t,e){if(!this.started)return!1;e&&e!==!0||(e={trigger:!!e}),t=this.getFragment(t||"");var i=this.root;""!==t&&"?"!==t.charAt(0)||(i=i.slice(0,-1)||"/");var s=i+t;if(t=this.decodeFragment(t.replace(pathStripper,"")),this.fragment!==t){if(this.fragment=t,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,s);else{if(!this._wantsHashChange)return this.location.assign(s);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var h=this.iframe.contentWindow;e.replace||(h.document.open(),h.document.close()),this._updateHash(h.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var s=t.href.replace(/(javascript:|#).*$/,"");t.replace(s+"#"+e)}else t.hash="#"+e},init:function(){return Object.setPrototypeOf(this,new EventEmitter)}},{checkUrl:{get:function(){return this._checkUrl.bind(this)},enumerable:!0,configurable:!0},location:{get:function(){return window.location},enumerable:!0,configurable:!0},history:{get:function(){return window.history},enumerable:!0,configurable:!0}});'}),loadFile({path:"/common/modules/i18n/index.js",pathName:"/common/modules/i18n/index.js",name:"index.js",dirName:"/common/modules/i18n/",contents:'"use strict";var process=require("process"),config=require(process.cwd()+"/configuration/i18n");module.exports=Object.defineProperties({translate:function(e,n,r){var t=r||this.currentLanguage,u=this.loadSection(e,t);return u?u[n]||n:n},init:function(){return this}},{currentLanguage:{get:function(){return config.currentLanguage},enumerable:!0,configurable:!0},sourceLanguage:{get:function(){return config.sourceLanguage},enumerable:!0,configurable:!0},loadSection:{get:function(){return config.loadSection},enumerable:!0,configurable:!0}});'}),loadFile({path:"/common/modules/meta/index.js",pathName:"/common/modules/meta/index.js",name:"index.js",dirName:"/common/modules/meta/",contents:'"use strict";var _get=function t(e,r,i){var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,r,i)}if("value"in o&&o.writable)return o.value;var s=o.get;if(void 0!==s)return s.call(i)},_inherits=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},_prototypeProperties=function(t,e,r){e&&Object.defineProperties(t,e),r&&Object.defineProperties(t.prototype,r)},_classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},_=require("underscore"),Tag=function(){function t(){_classCallCheck(this,t)}return _prototypeProperties(t,null,{attributes:{get:function(){return this._attributes||(this._attributes={},this._attributes)},set:function(t){this._attributes=t},configurable:!0},toString:{value:function(){return["<meta"].concat(_.pairs(this.attributes).map(function(t){return" "+t[0]+\'="\'+t[1]+\'" \'})).concat(">").join("")},writable:!0,configurable:!0}}),t}();exports.Tag=function(t){var e=function(t){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.attributes=t};return _inherits(e,t),e}(Tag),exports.Description=function(t){var e=function(t){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.attributes.content=t,this.attributes.name="description"};return _inherits(e,t),e}(Tag),exports.Charset=function(t){var e=function(t){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.attributes.charset=t};return _inherits(e,t),e}(Tag),exports.Keywords=function(t){var e=function(t){if(_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.attributes.name="keywords","string"==typeof t)this.attributes.content=t;else{if(!(t instanceof Array))throw new Error("keywords must be either string or array");this.attributes.content=t.join(", ")}};return _inherits(e,t),e}(Tag);'}),loadFile({path:"/common/modules/template-engine/index.js",pathName:"/common/modules/template-engine/index.js",name:"index.js",dirName:"/common/modules/template-engine/",contents:'"use strict";var smartPlurals=require("smart-plurals"),_=require("underscore");require("jsmart"),module.exports={init:function(){function r(r){var t=app.get("i18n");return r=_.values(r).filter(function(r){return _.isString(r)}),t.translate.apply(t,r)}return jSmart.prototype.registerPlugin("function","pluralize",function(r){var t=app.get("i18n"),e=smartPlurals.Plurals.getRule(t.currentLanguage);return r=_.values(r).filter(function(r){return _.isString(r)}).map(function(r){return+r||r}),e.call(null,r[0],r.slice(1))}),jSmart.prototype.registerPlugin("function","translate",r),jSmart.prototype.registerPlugin("function","t",r),jSmart.prototype.registerPlugin("function","include",function(r,t){var e=require(app.get("commonPath")+"/views/base"),n=new e;return n.templateDirs=t.templateDirs,n.getTemplate(r.file,t)}),jSmart}};'}),loadFile({path:"/common/modules/validation-engine/index.js",pathName:"/common/modules/validation-engine/index.js",name:"index.js",dirName:"/common/modules/validation-engine/",contents:'"use strict";var LIVR=require("livr");module.exports={init:function(){return LIVR.Validator.defaultAutoTrim(!0),LIVR.Validator}};'}),loadFile({path:"/common/classes/ajax-response.js",pathName:"/common/classes/ajax-response.js",name:"ajax-response.js",dirName:"/common/classes/",contents:'"use strict";var _prototypeProperties=function(t,r,e){r&&Object.defineProperties(t,r),e&&Object.defineProperties(t.prototype,e)},_classCallCheck=function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")};module.exports=function(){var t=function(){_classCallCheck(this,t),this.status=null,this.errors=null,this.data=null};return _prototypeProperties(t,{statusOK:{get:function(){return"success"},configurable:!0},statusError:{get:function(){return"error"},configurable:!0}}),t}();'}),loadFile({path:"/common/mappers/base.js",pathName:"/common/mappers/base.js",name:"base.js",dirName:"/common/mappers/",contents:'"use strict";var _prototypeProperties=function(e,r,o){r&&Object.defineProperties(e,r),o&&Object.defineProperties(e.prototype,o)},_classCallCheck=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},_=require("underscore");module.exports=function(){var e=function(){_classCallCheck(this,e)};return _prototypeProperties(e,null,{collection:{get:function(){return Array},configurable:!0},model:{get:function(){throw new Error("mapper should specify model")},configurable:!0},fileName:{get:function(){throw new Error("mapper should specify fileName")},configurable:!0},find:{value:function(){throw new Error("mapper should specify find method")},writable:!0,configurable:!0},findOne:{value:function(){throw new Error("mapper should specify findOne method")},writable:!0,configurable:!0},fromQueryObject:{value:function(){throw new Error("mapper should specify fromQueryObject method")},writable:!0,configurable:!0},populateModel:{value:function(e){return _.extend(new this.model,e)},writable:!0,configurable:!0},parseAsModel:{value:function(e){return e.length?this.populateModel(e[0]):null},writable:!0,configurable:!0},parseAsCollection:{value:function(e){return e=e.map(this.populateModel.bind(this)),new(this.collection.bind.apply(this.collection,[null].concat(e)))},writable:!0,configurable:!0},save:{value:function(e){var r=void 0;if(r=this.validateModel(e))return e instanceof this.model?this.update(r):this.insert(r);throw new Error("invalid data")},writable:!0,configurable:!0},validateModel:{value:function(){throw new Error("mapper should specify validateModel method")},writable:!0,configurable:!0},validationErrors:{get:function(){throw new Error("mapper should specify getter for validation errors")},configurable:!0},insert:{value:function(){throw new Error("mapper should specify insert method")},writable:!0,configurable:!0},update:{value:function(){throw new Error("mapper should specify update method")},writable:!0,configurable:!0}}),e}();'}),loadFile({path:"/common/mappers/knex-mapper.js",pathName:"/common/mappers/knex-mapper.js",name:"knex-mapper.js",dirName:"/common/mappers/",contents:'"use strict";var _prototypeProperties=function(e,r,i){r&&Object.defineProperties(e,r),i&&Object.defineProperties(e.prototype,i)},_get=function e(r,i,t){var u=Object.getOwnPropertyDescriptor(r,i);if(void 0===u){var n=Object.getPrototypeOf(r);return null===n?void 0:e(n,i,t)}if("value"in u&&u.writable)return u.value;var l=u.get;if(void 0!==l)return l.call(t)},_inherits=function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(e.__proto__=r)},_classCallCheck=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},BaseMapper=require("./base"),EventEmitter=require("events");module.exports=function(e){var r=function(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this),this.knex=require("knex")(e),this.schemaBuilder=this.knex.schema,this.emitter=new EventEmitter,app.serverSide(this.checkTable.bind(this))};return _inherits(r,e),_prototypeProperties(r,null,{queryBuilder:{get:function(){return new QueryBuilder(this.knex,this)},configurable:!0},checkTable:{value:function(){var e=this;this.schemaBuilder.hasTable(this.tableName).then(function(r){return r?void 0:e.schemaBuilder.createTableIfNotExists(e.tableName,function(r){e.beforeCreateTable(r),e.addColumns(r)}).then(function(){e.emit("table created")})})},writable:!0,configurable:!0},beforeCreateTable:{value:function(e){},writable:!0,configurable:!0},addColumns:{value:function(e){},writable:!0,configurable:!0},on:{value:function(){return this.emitter.on.apply(this.emitter,arguments)},writable:!0,configurable:!0},once:{value:function(){return this.emitter.once.apply(this.emitter,arguments)},writable:!0,configurable:!0},emit:{value:function(){return this.emitter.emit.apply(this.emitter,arguments)},writable:!0,configurable:!0},tableName:{get:function(){throw new Error("mapper should specify table name")},configurable:!0},find:{value:function(){return this.queryBuilder.select().dataParser(this.parseAsCollection.bind(this))},writable:!0,configurable:!0},findOne:{value:function(){return this.queryBuilder.select().dataParser(this.parseAsModel.bind(this))},writable:!0,configurable:!0},fromQueryObject:{value:function(e){return this.queryBuilder.fromQueryObject(e)},writable:!0,configurable:!0},insert:{value:function(e){return this.queryBuilder.insert(e).then(function(e){return e})["catch"](function(e){return e})},writable:!0,configurable:!0},update:{value:function(e){return this.queryBuilder.update(e).where({id:e.id}).then(function(e){return e})["catch"](function(e){return e})},writable:!0,configurable:!0}}),r}(BaseMapper);var QueryBuilder=function(){function e(r,i){_classCallCheck(this,e),this.knex=r,this.queryBuilder=r(i.tableName),this.mapper=i}return _prototypeProperties(e,null,{parser:{value:function(e){return e},writable:!0,configurable:!0},dataParser:{value:function(e){return this.parser=e,this},writable:!0,configurable:!0},select:{value:function(){return this.queryBuilder.select.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},as:{value:function(){return this.queryBuilder.as.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},column:{value:function(){return this.queryBuilder.column.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},from:{value:function(){return this.queryBuilder.from.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},withSchema:{value:function(){return this.queryBuilder.withSchema.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},where:{value:function(){return this.queryBuilder.where.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},whereNot:{value:function(){return this.queryBuilder.whereNot.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},whereIn:{value:function(){return this.queryBuilder.whereIn.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},whereNotIn:{value:function(){return this.queryBuilder.whereNotIn.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},whereNull:{value:function(){return this.queryBuilder.whereNull.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},whereNotNull:{value:function(){return this.queryBuilder.whereNotNull.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},whereExists:{value:function(){return this.queryBuilder.whereExists.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},whereNotExists:{value:function(){return this.queryBuilder.whereNotExists.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},whereBetween:{value:function(){return this.queryBuilder.whereBetween.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},whereNotBetween:{value:function(){return this.queryBuilder.whereNotBetween.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},whereRaw:{value:function(){return this.queryBuilder.whereRaw.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},innerJoin:{value:function(){return this.queryBuilder.innerJoin.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},leftJoin:{value:function(){return this.queryBuilder.leftJoin.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},leftOuterJoin:{value:function(){return this.queryBuilder.leftOuterJoin.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},rightJoin:{value:function(){return this.queryBuilder.rightJoin.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},rightOuterJoin:{value:function(){return this.queryBuilder.rightOuterJoin.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},outerJoin:{value:function(){return this.queryBuilder.outerJoin.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},fullOuterJoin:{value:function(){return this.queryBuilder.fullOuterJoin.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},crossJoin:{value:function(){return this.queryBuilder.crossJoin.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},joinRaw:{value:function(){return this.queryBuilder.joinRaw.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},distinct:{value:function(){return this.queryBuilder.distinct.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},groupBy:{value:function(){return this.queryBuilder.groupBy.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},groupByRaw:{value:function(){return this.queryBuilder.groupByRaw.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},orderBy:{value:function(){return this.queryBuilder.orderBy.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},orderByRaw:{value:function(){return this.queryBuilder.orderByRaw.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},having:{value:function(){return this.queryBuilder.having.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},offset:{value:function(){return this.queryBuilder.offset.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},limit:{value:function(){return this.queryBuilder.limit.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},union:{value:function(){return this.queryBuilder.union.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},unionAll:{value:function(){return this.queryBuilder.unionAll.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},insert:{value:function(){return this.queryBuilder.insert.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},returning:{value:function(){return this.queryBuilder.returning.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},update:{value:function(){return this.queryBuilder.update.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},del:{value:function(){return this.queryBuilder.del.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},transaction:{value:function(){return this.queryBuilder.transaction.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},transacting:{value:function(){return this.queryBuilder.transacting.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},forUpdate:{value:function(){return this.queryBuilder.forUpdate.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},forShare:{value:function(){return this.queryBuilder.forShare.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},count:{value:function(){return this.queryBuilder.count.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},min:{value:function(){return this.queryBuilder.min.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},max:{value:function(){return this.queryBuilder.max.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},sum:{value:function(){return this.queryBuilder.sum.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},increment:{value:function(){return this.queryBuilder.increment.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},decrement:{value:function(){return this.queryBuilder.decrement.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},truncate:{value:function(){return this.queryBuilder.truncate.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},pluck:{value:function(){return this.queryBuilder.pluck.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},first:{value:function(){return this.queryBuilder.first.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},clone:{value:function(){return this.queryBuilder.clone.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},modify:{value:function(){return this.queryBuilder.modify.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},columnInfo:{value:function(){return this.queryBuilder.columnInfo.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},debug:{value:function(){return this.queryBuilder.debug.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},connection:{value:function(){return this.queryBuilder.connection.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},options:{value:function(){return this.queryBuilder.options.apply(this.queryBuilder,arguments),this},writable:!0,configurable:!0},then:{value:function(e){var r=this;return new Promise(function(i,t){app.serverSide(function(){r.queryBuilder.then(function(t){i(e(r.parser(t)))})}),app.clientSide(function(){var u=require("jquery"),n={mapper:r.mapper.fileName,queryObject:r.toQueryObject()};u.post("/rest/query",n,null,"json").error(function(e,r,i){t(e)}).then(function(t){i(e(r.parser(t)))})})}).then(function(e){return e})},writable:!0,configurable:!0},toQueryObject:{value:function(){var e=this,r={};return Object.keys(this.queryBuilder).filter(function(e){return"_"==e[0]}).forEach(function(i){return r[i]=e.queryBuilder[i]}),r},writable:!0,configurable:!0},toString:{value:function(){return this.queryBuilder.toString()},writable:!0,configurable:!0},boolify:{value:function(e){for(var r in e)e.hasOwnProperty(r)&&("object"==typeof e[r]&&this.boolify(e[r]),"false"===e[r]&&(e[r]=!1),"true"===e[r]&&(e[r]=!0))},writable:!0,configurable:!0},fromQueryObject:{value:function(e){this.boolify(e),Object.assign(this.queryBuilder,e);var r=this.queryBuilder.toString();if(this.validateQuery(r))return this.queryBuilder.then(function(e){return e});throw new Error("invalid query")},writable:!0,configurable:!0},validateQuery:{value:function(e){return this.mapper.validateQuery?this.mapper.validateQuery(e):!/join|union|insert|update|delete/.test(e)&&new RegExp("from\\\\s+\\\\S*"+this.mapper.tableName+"\\\\S*").test(e)},writable:!0,configurable:!0}}),e}();'
}),loadFile({path:"/common/routers/get.js",pathName:"/common/routers/get.js",name:"get.js",dirName:"/common/routers/",contents:'"use strict";var _prototypeProperties=function(e,t,o){t&&Object.defineProperties(e,t),o&&Object.defineProperties(e.prototype,o)},_inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},_classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},baseRouter=require(app.get("classPath")+"/routers/base"),DomDocument=require(app.get("classPath")+"/classes/dom-document"),process=require("process"),theme=require(process.cwd()+"/configuration/theme-light"),domDocumentObj=new DomDocument(theme);module.exports=function(e){var t=function(){_classCallCheck(this,t),null!=e&&e.apply(this,arguments)};return _inherits(t,e),_prototypeProperties(t,null,{index:{value:function(e,t){var o=this,r=new(require("../views/main-page"))(theme);r.render().then(function(e){domDocumentObj.setBlock("main",e),o.loadPage(domDocumentObj,t)})},writable:!0,configurable:!0}}),t}(baseRouter);'}),loadFile({path:"/common/views/base.js",pathName:"/common/views/base.js",name:"base.js",dirName:"/common/views/",contents:'"use strict";var _prototypeProperties=function(e,t,i){t&&Object.defineProperties(e,t),i&&Object.defineProperties(e.prototype,i)},_classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},fs=require("fs"),_=require("underscore");module.exports=function(){var e=function(){var t=this;_classCallCheck(this,e),app.clientSide(function(){t.cid=_.uniqueId("view"),t._ensureElement()})};return _prototypeProperties(e,null,{tagName:{get:function(){return"div"},configurable:!0},$:{value:function(e){return this.$el.find(e)},writable:!0,configurable:!0},render:{value:function(){},writable:!0,configurable:!0},remove:{value:function(){return this._removeElement(),this},writable:!0,configurable:!0},_removeElement:{value:function(){this.$el.remove()},writable:!0,configurable:!0},setElement:{value:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},writable:!0,configurable:!0},_setElement:{value:function(e){var t=require("jquery");this.$el=e instanceof t?e:t(e)},writable:!0,configurable:!0},delegateEvents:{value:function(e){if(e||(e=_.result(this,"events")),!e)return this;this.undelegateEvents();for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];if(_.isFunction(i)||(i=this[i]),!i)continue;var r=t.match(/^(\\S+)\\s*(.*)$/);this.delegate(r[1],r[2],_.bind(i,this))}return this},writable:!0,configurable:!0},delegate:{value:function(e,t,i){return this.$el.on(""+e+".delegateEvents"+this.cid,t,i),this},writable:!0,configurable:!0},undelegateEvents:{value:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},writable:!0,configurable:!0},undelegate:{value:function(e,t,i){return this.$el.off(""+e+".delegateEvents"+this.cid,t,i),this},writable:!0,configurable:!0},_createElement:{value:function(e){return document.createElement(e)},writable:!0,configurable:!0},_ensureElement:{value:function(){if(this.el)this.setElement(_.result(this,"el"));else{var e=_.extend({},_.result(this,"attributes"));this.id&&(e.id=_.result(this,"id")),this.className&&(e["class"]=_.result(this,"className")),this.setElement(this._createElement(_.result(this,"tagName"))),this._setAttributes(e)}},writable:!0,configurable:!0},_setAttributes:{value:function(e){this.$el.attr(e)},writable:!0,configurable:!0},setTemplateDir:{value:function(e){return _.isArray(e)?this.templateDirs=e:this.templateDirs=[e],this},writable:!0,configurable:!0},addTemplateDir:{value:function(e){return!this.templateDirs&&(this.templateDirs=[]),_.isArray(e)?this.templateDirs.concat(e):this.templateDirs.push(e),this},writable:!0,configurable:!0},getTemplate:{value:function(e,t){for(var i in this.templateDirs)if(this.templateDirs.hasOwnProperty(i)){var r=this.templateDirs[i],n=""+r+"/"+e;try{fs.accessSync(n);var s=fs.readFileSync(n,"utf8");if(s)return this.compile(s,t)}catch(a){}}throw new Error("cannot find template "+e)},writable:!0,configurable:!0},compile:{value:function(e,t){try{var i=app.get("templateEngine"),r=new i(e);return r.fetch(Object.assign(t||{},{templateDirs:this.templateDirs}))}catch(n){console.error(n)}},writable:!0,configurable:!0}}),e}();'}),loadFile({path:"/common/views/file-upload-form.js",pathName:"/common/views/file-upload-form.js",name:"file-upload-form.js",dirName:"/common/views/",contents:'"use strict";var _prototypeProperties=function(e,t,r){t&&Object.defineProperties(e,t),r&&Object.defineProperties(e.prototype,r)},_get=function e(t,r,n){var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o&&o.writable)return o.value;var a=o.get;if(void 0!==a)return a.call(n)},_inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},_classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},FormView=require("./form"),$=require("jquery");module.exports=function(e){var t=function(){_classCallCheck(this,t),null!=e&&e.apply(this,arguments)};return _inherits(t,e),_prototypeProperties(t,null,{serializeData:{value:function(e){return Object.assign(_get(Object.getPrototypeOf(t.prototype),"serializeData",this).call(this,e),Array.from(e.querySelectorAll("input[type=file]")).reduce(function(e,t){return e[t.name]=Array.from(t.files).map(function(e){return["lastModifiedDate","name","lastModified","size","type"].reduce(function(t,r){return t[r]=e[r],t},{})}).concat(function(){return e[t.name]||[]}()),e},{}))},writable:!0,configurable:!0},processData:{value:function(e,t){return new FormData(t)},writable:!0,configurable:!0},send:{value:function(e,t){var r=this.onProgress.bind(this);return $.ajax({url:e,type:"post",xhr:function n(){var n=$.ajaxSettings.xhr();return n.upload&&n.upload.addEventListener("progress",r,!1),n},data:t,cache:!1,contentType:!1,processData:!1},"json")},writable:!0,configurable:!0},onProgress:{value:function(){},writable:!0,configurable:!0}}),t}(FormView);'}),loadFile({path:"/common/views/form.js",pathName:"/common/views/form.js",name:"form.js",dirName:"/common/views/",contents:'"use strict";var _prototypeProperties=function(e,t,r){t&&Object.defineProperties(e,t),r&&Object.defineProperties(e.prototype,r)},_inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},_classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},BaseView=require("./base"),$=require("jquery"),AjaxResponse=require("../classes/ajax-response");module.exports=function(e){var t=function(){_classCallCheck(this,t),null!=e&&e.apply(this,arguments)};return _inherits(t,e),_prototypeProperties(t,null,{events:{get:function(){return{submit:"submit"}},configurable:!0},submit:{value:function(e){var t=this;e.preventDefault();var r=e.target,n=this.validate(this.serializeData(r));n?this.send(r.action,this.processData(n,r)).then(function(e){t.isRequestSuccess(e)?t.onSuccess(e):t.onError(e)}):this.onValidationError()},writable:!0,configurable:!0},processData:{value:function(e){return e},writable:!0,configurable:!0},isRequestSuccess:{value:function(e){return e.status==AjaxResponse.statusOK},writable:!0,configurable:!0},onSuccess:{value:function(){},writable:!0,configurable:!0},onError:{value:function(){},writable:!0,configurable:!0},serializeData:{value:function(e){return this.toJSON.call(e)},writable:!0,configurable:!0},send:{value:function(e,t){return $.post(e,t,null,"json")},writable:!0,configurable:!0},toJSON:{value:function(){var e={},t={},r={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\\[(?:\\d*|[a-zA-Z0-9_]+)\\])*$/,key:/[a-zA-Z0-9_]+|(?=\\[\\])/g,push:/^$/,fixed:/^\\d+$/,named:/^[a-zA-Z0-9_]+$/},n=function(e,t,r){return e[t]=r,e},a=function(e){return void 0===t[e]&&(t[e]=0),t[e]++};return $.each($(this).serializeArray(),function(){if(r.validate.test(this.name)){for(var t=void 0,i=this.name.match(r.key),o=this.value,u=this.name;void 0!==(t=i.pop());)u=u.replace(new RegExp("\\\\["+t+"\\\\]$"),""),t.match(r.push)?o=n([],a(u),o):t.match(r.fixed)?o=n([],t,o):t.match(r.named)&&(o=n({},t,o));e=$.extend(!0,e,o)}}),e},writable:!0,configurable:!0},validate:{value:function(e){return e},writable:!0,configurable:!0},onValidationError:{value:function(){},writable:!0,configurable:!0}}),t}(BaseView);'}),loadFile({path:"/common/views/main-page.js",pathName:"/common/views/main-page.js",name:"main-page.js",dirName:"/common/views/",contents:'"use strict";var _prototypeProperties=function(e,t,r){t&&Object.defineProperties(e,t),r&&Object.defineProperties(e.prototype,r)},_get=function e(t,r,o){var n=Object.getOwnPropertyDescriptor(t,r);if(void 0===n){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,o)}if("value"in n&&n.writable)return n.value;var a=n.get;if(void 0!==a)return a.call(o)},_inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},_classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},BaseView=require("./base");module.exports=function(e){var t=function(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.setTemplateDir(e.templatesPath+"/main-page")};return _inherits(t,e),_prototypeProperties(t,null,{render:{value:function(){var e=this;return new Promise(function(t){var r=e.getTemplate("index.tpl.html");t(r)})},writable:!0,configurable:!0}}),t}(BaseView);'}),loadFile({path:"/configuration/routes.js",pathName:"/configuration/routes.js",name:"routes.js",dirName:"/configuration/",contents:'"use strict";module.exports={get:{"/":"index"},rest:{"/rest/query":"query"}};'}),loadFile({path:"/configuration/runtime.js",pathName:"/configuration/runtime.js",name:"runtime.js",dirName:"/configuration/",contents:'"use strict";var process=require("process");module.exports={main:process.cwd()+"/front/index.js"};'}),loadFile({path:"/configuration/components.js",pathName:"/configuration/components.js",name:"components.js",dirName:"/configuration/",contents:'"use strict";module.exports={templateEngine:require(app.get("commonPath")+"/modules/template-engine"),validationEngine:require(app.get("commonPath")+"/modules/validation-engine"),i18n:require(app.get("commonPath")+"/modules/i18n"),history:require(app.get("commonPath")+"/modules/history")};'}),loadFile({path:"/configuration/static.js",pathName:"/configuration/static.js",name:"static.js",dirName:"/configuration/",contents:'"use strict";var process=require("process");module.exports={build:process.cwd()+"/static/build",bundleResult:process.cwd()+"/static/bundle-result.js",clean:"static/build/*",prefix:"/build"};'}),loadFile({path:"/configuration/theme-light.js",pathName:"/configuration/theme-light.js",name:"theme-light.js",dirName:"/configuration/",contents:'"use strict";var process=require("process"),themePath=process.cwd()+"/themes/theme-light",templatesPath=themePath+"/templates",stylesPath=themePath+"/styles",viewsPath=themePath+"/js/views";try{var lazypipe=require("lazypipe"),stylus=require("gulp-stylus"),nib=require("nib"),bundleOptions={minifyTemplates:!0,watchTemplates:!0,minifyStyles:!0,watchStyles:!0,transforms:{styles:lazypipe().pipe(stylus,{include:[themePath+"/includes/stylus"],"import":["_variables","nib"],use:nib()})}}}catch(e){bundleOptions={}}module.exports={path:themePath,templatesPath:templatesPath,viewsPath:viewsPath,bundles:{"theme-light":{templates:[templatesPath+"/**/*.tpl.html"],styles:[stylesPath+"/**/*.styl"],options:Object.assign({},bundleOptions)}}};'}),loadFile({path:"/configuration/i18n.js",pathName:"/configuration/i18n.js",name:"i18n.js",dirName:"/configuration/",contents:'"use strict";module.exports={sourceLanguage:"ru",currentLanguage:"ru",loadSection:function(u,e){}};'});